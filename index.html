<!DOCTYPE html>
<html>

<head>
  <title>Documentación API</title>
  <meta charset="UTF-8" />
  <link rel="icon" type="image/png" href="https://tubusquedaweb.com/favicon.png" />
  <script src="https://cdn.redoc.ly/redoc/latest/bundles/redoc.standalone.js"></script>
  <style>
    html,
    body,
    #redoc-container {
      height: 100%;
      margin: 0;
      padding: 0;
    }

    header {
      background: #f7f7f7;
      padding: 10px 20px;
      display: flex;
      align-items: center;
      gap: 15px;
      border-bottom: 1px solid #ccc;
    }

    header img {
      height: 50px;
    }

    header h1 {
      font-family: sans-serif;
      font-size: 20px;
      margin: 0;
    }
  </style>
</head>

<body>
  <header>
    <img src="https://tubusquedaweb.com/logo.svg" alt="sbi" />
    <h1>Documentación API</h1>
  </header>

  <div id="redoc-container"></div>

  <script>
    const spec = {
      openapi: "3.0.3",
      info: {
        title: "API - CRM SBI",
        version: "1.0.0",
        description: "Documentación centralizada de **todas** las APIs del sistema SBI.\n\n- SBS\n- Essalud\n- Deudas por entidad\n- Datos por persona"
      },
      servers: [
        {
          url: "https://tu-api.com",
          description: "Servidor Producción - Externas"
        }
      ],
      paths: {
        "/datos": {
          post: {
            tags: ["Completo"],
            summary: "Obtener información completa (datos, SBS, Essalud, etc.)",
            description: "Este endpoint devuelve información general, SBS y Essalud a partir del documento enviado.",
            requestBody: {
              required: true,
              content: {
                "application/json": {
                  schema: {
                    type: "object",
                    properties: {
                      key: {
                        type: "string",
                        description: "Token de autorización",
                        example: "api-key-123"
                      },
                      documento: {
                        type: "string",
                        description: "Número de documento del cliente",
                        example: "12345678"
                      },
                      meses: {
                        type: "integer",
                        description: "Cantidad de meses de historial",
                        example: 6
                      },
                      planilla: {
                        type: "integer",
                        description: "Filtro de meses para planilla (opcional)",
                        example: 6
                      }
                    },
                    required: ["key", "documento", "meses"]
                  }
                }
              }
            },
            responses: {
              "200": {
                description: "Datos obtenidos correctamente"
              }
            }
          }
        },

        "/persona/{documento}": {
          get: {
            tags: ["Completo"],
            summary: "Retorna persona",
            description: "Obtiene la información de una persona a partir de su documento de identidad.",
            parameters: [
              {
                name: "documento",
                in: "path",
                required: true,
                schema: {
                  type: "string",
                  example: "12345678"
                },
                description: "Número de documento (DNI, RUC, etc.)"
              }
            ],
            responses: {
              "200": {
                description: "Operación exitosa - Información de la persona",
                content: {
                  "application/json": {
                    example: {
                      documento: "12345678",
                      nombres: "JUAN PÉREZ",
                      telefono: "999999999",
                      correo: "juan@example.com",
                      direccion: "Av. Principal 123",
                      ocupacion: "Analista de datos",
                      sbs: {
                        calificacion: "Normal",
                        entidades: ["BCP", "Interbank"]
                      },
                      essalud: {
                        afiliado: true,
                        empresa: "Mi Empresa SAC"
                      }
                    }
                  }
                }
              },
              "404": {
                description: "Persona no encontrada con el documento ingresado"
              }
            }
          }
        },

        "/rcc": {
          post: {
            tags: ["RCC"],
            summary: "Reporte de calificaciones SBS (24 meses)",
            description: "Devuelve el historial de calificaciones crediticias del cliente en los últimos 24 meses.",
            requestBody: {
              required: true,
              content: {
                "application/json": {
                  schema: {
                    type: "object",
                    properties: {
                      key: {
                        type: "string",
                        description: "Token de autorización",
                        example: "api-key-123"
                      },
                      documento: {
                        type: "string",
                        description: "Número de documento del cliente",
                        example: "12345678"
                      }
                    },
                    required: ["key", "documento"]
                  }
                }
              }
            },
            responses: {
              "200": {
                description: "Devuelve historial de calificaciones mensuales (normal, cpp, deficiente, etc.)."
              }
            }
          }
        },

        "/deudas_por_entidad": {
          post: {
            tags: ["Deudas por entidad"],
            summary: "Consulta detallada de deudas por entidad financiera",
            description: "Devuelve relación de deudas por entidad financiera, tipo de crédito, calificación y monto.",
            requestBody: {
              required: true,
              content: {
                "application/json": {
                  schema: {
                    type: "object",
                    properties: {
                      key: {
                        type: "string",
                        description: "Token de autorización",
                        example: "api-key-123"
                      },
                      documento: {
                        type: "string",
                        description: "Documento del cliente a consultar",
                        example: "12345678"
                      }
                    },
                    required: ["key", "documento"]
                  }
                }
              }
            },
            responses: {
              "200": {
                description: "Lista detallada de deudas con empresa, tipo de crédito, calificación SBS y atraso."
              }
            }
          }
        }
      }
    };

    Redoc.init(spec, {
      scrollYOffset: 60,
      expandResponses: "200,404",
      requiredPropsFirst: true
    }, document.getElementById("redoc-container"));
  </script>
</body>

</html>